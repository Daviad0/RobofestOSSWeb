
@using RobofestWTECore.Models
@{
    ViewBag.Title = "Field";
}
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
    .btn-group {
        display: flex;
    }

    .btn {
        flex: 1
    }

    btn-default: {
        background-color: gray
    }

    .big {
        font-size: 1.2em;
        border: none;
        border-radius: 4px;
    }
    .fa-input {
  font-family: FontAwesome, 'Helvetica Neue', Helvetica, Arial, sans-serif;
}

    .custom-dropdown {
        position: relative;
        display: inline-block;
        vertical-align: middle;
        margin: 10px; /* demo only */
    }

        .custom-dropdown select {
            background-color: #1abc9c;
            color: #fff;
            font-size: inherit;
            padding: .5em;
            padding-right: 2.5em;
            border: 0;
            margin: 0;
            border-radius: 3px;
            text-indent: 0.01px;
            text-overflow: '';
            -webkit-appearance: button; /* hide default arrow in chrome OSX */
        }

        .custom-dropdown::before,
        .custom-dropdown::after {
            content: "";
            position: absolute;
            pointer-events: none;
        }

        .custom-dropdown::after { /*  Custom dropdown arrow */
            content: "\25BC";
            height: 1em;
            font-size: .625em;
            line-height: 1;
            right: 1.2em;
            top: 50%;
            margin-top: -.5em;
        }

        .custom-dropdown::before { /*  Custom dropdown arrow cover */
            width: 2em;
            right: 0;
            top: 0;
            bottom: 0;
            border-radius: 0 3px 3px 0;
        }

        .custom-dropdown select[disabled] {
            color: rgba(0,0,0,.3);
        }

            .custom-dropdown select[disabled]::after {
                color: rgba(0,0,0,.1);
            }

        .custom-dropdown::before {
            background-color: rgba(0,0,0,.15);
        }

        .custom-dropdown::after {
            color: rgba(0,0,0,.4);
        }

    .footer {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        background-color: lightgray;
        color: white;
        text-align: center;
    }

    .createforms {
        border: none;
        border-bottom: 2px solid gray;
        padding-left: 2px;
        transition: 0.3s;
        border-radius: 4px;
    }

        .createforms:hover {
            background-color: #ededed;
            padding-left: 5px;
        }

        .createforms:focus {
            border-bottom: 2px solid red;
            background-color: #ededed;
            padding-left: 5px;
        }

        .createforms:disabled, .createforms:read-only {
            cursor: not-allowed;
            padding-left: 2px;
            transition: 0.3s;
        }

            .createforms:disabled:hover, .createforms:disabled:active, .createforms:read-only:hover, .createforms:read-only:active {
                cursor: not-allowed;
                background-color: red;
                padding-left: 5px;
                opacity: 0.6;
            }

    .text-danger {
        text-align: center;
    }

    #overlay {
        position: fixed;
        display: none;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0,0,0,0.5);
        z-index: 2;
        cursor: pointer;
    }

    .textoverlay {
        position: absolute;
        top: 50%;
        left: 50%;
        font-size: 50px;
        color: black;
        background-color: white;
        transform: translate(-50%,-50%);
        -ms-transform: translate(-50%,-50%);
    }

    .judgehelp {
        animation-name: color;
        animation-duration: 1s;
        animation-iteration-count: infinite;
    }

    @@keyframes color {
        0% {
            background-color: yellow
        }

        50% {
            background-color: red;
        }
    }

    .column {
        float: left;
    }

    .left {
        width: 25%;
    }

    .right {
        width: 75%;
    }

    /* Clear floats after the columns */
    .row:after {
        content: "";
        display: table;
        clear: both;
    }

    .autofields {
        display: none;
    }

    .centered {
        display: inherit;
        justify-content: center;
    }

    .btn {
        width: 20%;
    }

    .footer {
        position: fixed;
        height: 100px;
        bottom: 0;
        width: 100%;
        background-color: orange;
    }.ournavbar{
         display:none;
     }
     .navbarfade{
         transition: background-color 0.7s;
     }
     .btn-score{
         border:1px solid dodgerblue;
         background-color:white;
         color:dodgerblue;
         border-radius:6px;
         padding:5px;
         font-weight:600;
     }.btn-score:hover{
         border:1px solid dodgerblue;
         background-color:white;
         color:dodgerblue;
         border-radius:6px;
         padding:5px;
      }.btn-score:focus{
         border:1px solid dodgerblue;
         background-color:lightblue;
         color:dodgerblue;
         border-radius:6px;
         padding:5px;
      }
    .btn-score-neg{
         border:1px solid orangered;
         background-color:white;
         color:orangered;
         border-radius:6px;
         padding:5px;
         font-weight:600;
     }
        .btn-score-neg:hover {
            border: 1px solid orangered;
            background-color: white;
            color: orangered;
            border-radius: 6px;
            padding: 5px;
        }
        .btn-score-neg:focus {
            border: 1px solid orangered;
            background-color: #ffd3cc;
            color: orangered;
            border-radius: 6px;
            padding: 5px;
        }
    .score-popup {
        position: fixed;
        bottom: 15px;
        right: 15px;
        z-index: 9;

    }
    .statuschange{
        transition: color 0.7s;
    }
</style>
<script src='https://kit.fontawesome.com/a076d05399.js'></script>


<nav class="navbar navbar-inverse navbar-fixed-top navbarfade" style="background-color:black;border:none" id="navbarcolor">
    <div style="width:100%;color:white;font-weight:600;text-align:center;height:50px;margin-top:20px">
        <span style="font-size:20px" id="navbartext">Score: 0</span>
    </div>
</nav>
<div id="awaitingscorekeeper" style="text-align:center">
    <br />
    <span class="fas fa-times" id="notreadyicon" style="font-size:80px;color:gray"></span>
    <span class="fas fa-check" id="readyicon" style="font-size:80px;color:green;display:none"></span>
    <br />
    <span class="fas statuschange" style="font-size:25px;color:gray">TASK: STAY IN CORRECT ZONE FOR 3s</span>
    <br />
    <span class="fas statuschange" id="taskstatus" style="font-size:20px;color:gray">NOT COMPLETED</span>
    <br />
    <br />
    <span style="color:red;font-weight:600;font-size:30px;margin-right:20px">SENSOR</span>
    <table style="width:70%;display:inline">
        <tr>
            <td style="background-color:lightgray;border:1px solid black;border-left:10px solid red" id="z1" class="zones">
                <span style="font-size:50px;margin:70px">Z1</span>
            </td>
            <td style="background-color:lightgray;border:1px solid black" id="z2" class="zones">
                <span style="font-size:50px;margin:70px">Z2</span>
            </td>
            <td style="background-color:lightgray;border:1px solid black" id="z3" class="zones">
                <span style="font-size:50px;margin:70px">Z3</span>
            </td>
            <td style="background-color:lightgray;border:1px solid black" id="z4" class="zones">
                <span style="font-size:50px;margin:70px">Z4</span>
            </td>
        </tr>
    </table>
    <br />
    <br />
    <div style="display:inline-block;border-radius:10px;border:1px solid black;padding:50px">
        <span style="font-size:40px" class="fas">ZONE TO OCCUPY:</span>
        <br />
        <span style="font-size:50px" class="fas" id="zoneselection">??????</span>
    </div>
</div>
<br />
<br />

<script src="~/lib/signalr/dist/browser/signalr.js"></script>
<script src="~/lib/jquery/dist/jquery.js"></script>

<script>

    $(function () {
        var chat = new signalR.HubConnectionBuilder().withUrl("/RobofestWTECore/scoreHub").build();

        var fieldsub = 0;
        var teamnumber = "";
        var lockedin = false;
        var randomZone = Math.floor(Math.random() * 4) + 1
        $("#zoneselection").html("ZONE " + randomZone)
        chat.on("zoneGot", function (zoneNum) {
            if (zoneNum == randomZone) {
                $("#notreadyicon").css("display", "none")
                $("#readyicon").css("display", "inline")
                $(".statuschange").css("color", "green")
                $("#taskstatus").html("COMPLETED")
                $("#navbartext").html("Score: 20")
            } else {
                $("#notreadyicon").css("color", "red")
                $(".statuschange").css("color", "red")
                $("#taskstatus").html("FAILED")
            }
        });
        chat.on("currentZone", function (zoneNum) {
            $(".zones").css("background-color", "lightgray")
            if (zoneNum == randomZone) {
                $("#z" + zoneNum).css("background-color", "aquamarine")
            } else {
                $("#z" + zoneNum).css("background-color", "palevioletred")
            }
        });
        chat.start().then(function () {
            $(".roundbutton1").click(function () {
                publicround = 1;
            });
            $(".roundbutton2").click(function () {
                publicround = 2;
            });
            $("#judgeaccesscode").change(function () {
                if ($("#judgeaccesscode").val() == 1234) {
                    //INSERT CORRECT ACCESS CODE HERE
                    $("#create").css("display", "inline");
                    $("#judgeaccesscode").attr("disabled", true);
                }
            });
            $("#sendchat").click(function () {
                var message = $("#usermessage").val();
                var sender = "Field " + fieldsub + " (Judge)"
                var issue = $("#userissue").is(":checked");
                chat.invoke("sendMessage",message, issue, sender)
                $("#usermessage").val("");
            });
            $("#disablescoreupdate").click(function () {
                checkingscore = false;
                chat.invoke("initField",fieldsub, 5, totalscore, teamnumber, checkingscore, false);
                $("#currentscorestatus").html("Score Updating Disabled!");
            });
            $("#lookupteam").change(function () {
                chat.invoke("lookUpTeam",parseFloat($("#lookupteam").val()));
            });
            $("#emergencyhelp").click(function () {
                if (emergency == false) {
                    $("#emergencyhelp").addClass("judgehelp");
                    $("#emergencyhelp").css("background-color", "yellow");
                    chat.invoke("sendMessage", "Help Requested from Field " + fieldsub + "!!", true, "Field " + fieldsub + " (Server)")
                    chat.invoke("judgeHelp",fieldsub, true);
                    emergency = true;
                } else {
                    $("#emergencyhelp").removeClass("judgehelp");
                    $("#emergencyhelp").css("background-color", "");
                    chat.invoke("judgeHelp",fieldsub, false);
                    emergency = false;
                }
            });
           
            $("#enablescoreupdate").click(function () {
                checkingscore = true;
                $("#currentscorestatus").html("Score Updating Enabled!");
            });
            $(document).ready(function () {
                chat.invoke("lookUpTeam", parseFloat($("#lookupteam").val()));
                chat.invoke("judgeClientConnection");
            });
           
            $("#finalize").click(function () {
                $("#confirmmatch").attr("hidden", false);
                $(".beforeconfirmation").css("display", "none");
                $(".scoresheet").attr("disabled", true);
                $("#readybar").attr("hidden", true);
                $(".btn-score").attr("disabled",true)
                $(".btn-score-neg").attr("disabled", true)
                $("#navbartext").html("Does everyone agree?")
                $("#navbartimer").css("display","none")
                $("#navbarscore").css("display","none")
                $("#navbarcolor").css("background-color", "dodgerblue")
                $("#finalize").css("display","none")
                document.body.scrollTop = 0;
                document.documentElement.scrollTop = 0;
            });
            $("#donotfinalize").click(function () {
                $("#confirmmatch").attr("hidden", true);
                $(".beforeconfirmation").css("display", "block");
                $(".scoresheet").attr("disabled", false);
                $("#judgeconfirm").val("");
                $("#studentconfirm").val("");
                $("#readybar").attr("hidden", false);
                $(".btn-score").attr("disabled",false)
                $(".btn-score-neg").attr("disabled", false)
                $("#navbartext").html("")
                $("#navbartimer").css("display","inline")
                $("#navbarscore").css("display","inline")
                $("#navbarcolor").css("background-color", "black")
                $("#finalize").css("display","inline")
                document.body.scrollTop = 0;
                document.documentElement.scrollTop = 0;
            });
            $("#readystatus").click(function () {
                if (lockedin == true) {
                    chat.invoke("initField", fieldsub, 2, totalscore, teamnumber, checkingscore, false, "0/0/0/0/0^0/0/0/0^0/0^0/0");
                    $("#fieldissue").text("");
                    $("#notreadystatus").css("font-weight", "normal");
                    $("#readystatus").css("font-weight", "bold");
                    $("#readyicon").css("display", "inline")
                    $("#notreadyicon").css("display", "none")
                    $("#notreadystatus").css("display", "inline")
                    $("#readystatus").css("display", "none")
                    $("#navbartext").html("You are READY")
                    $("#navbartimer").css("display", "none")
                    $("#navbarscore").css("display", "none")
                    $("#navbarcolor").css("background-color", "green")
                    $(".statuschange").css("color", "green")
                }
            });
            $("#notreadystatus").click(function () {
                if (lockedin == true) {
                    chat.invoke("initField", fieldsub, 1, totalscore, teamnumber, checkingscore, false, "0/0/0/0/0^0/0/0/0^0/0^0/0");
                    $("#fieldissue").text("");
                    $("#notreadystatus").css("font-weight", "bold");
                    $("#readystatus").css("font-weight", "normal");
                    $("#readyicon").css("display", "none")
                    $("#notreadyicon").css("display", "inline")
                    $("#notreadystatus").css("display", "none")
                    $("#readystatus").css("display", "inline")
                    $("#navbartext").html("You are NOT READY")
                    $("#navbartimer").css("display", "none")
                    $("#navbarscore").css("display", "none")
                    $("#navbarcolor").css("background-color", "red")
                    $(".statuschange").css("color", "red")
                }
            });
            $('#starttimer').click(function () {
                // Call the Send method on the hub.

                // Clear text box and reset focus for next comment.
                $('#message').val('').focus();
            });
            $(".fieldselector").click(function () {
                somethingselected = true;
                $("#teamselected").attr("disabled",false)
                $(".fieldselector").css("background-color", "white");
                $(".fieldselector").css("color", "dodgerblue");
                var field = parseInt(this.value);
                if (field < 7) {
                    $("#f" + field + "selector").css("background-color", "dodgerblue");
                    $("#f" + field + "selector").css("color", "white");
                    $("#fieldn").val(field)
                    $("#lookupteam").val(defaultfields[field-1][0])
                    $("#teamnumber").val(defaultfields[field - 1][1])
                    $("#selectedteamnumber").html(defaultfields[field - 1][1])
                    $("#selectedteamid").html("(DBID: " + defaultfields[field - 1][0] + ")")
                    $("#selectedfieldnum").html("FIELD " + field)
                    if (defaultfields[field - 1][2] == 1) {
                        $("#round1").trigger('click');
                        publicround = 1
                    } else if (defaultfields[field-1][2] == 2) {
                        $("#round2").trigger('click');
                        publicround = 2
                    }
                    $("#manualinput").css("display", "none")
                    $("#automaticinput").css("display", "block")
                    $("#lookupteam").attr("readonly", true)
                    $("#fieldn").attr("readonly", true)
                } else {
                    $("#atselector").css("background-color", "dodgerblue");
                    $("#atselector").css("color", "white");
                    $("#manualinput").css("display", "block")
                    $("#automaticinput").css("display", "none")
                    $("#lookupteam").attr("readonly", false)
                    $("#fieldn").attr("readonly", false)
                }
                
            });
            $(".roundbutton1").click(function () {
                $(".roundbutton2").css("background-color","white")
                $(".roundbutton2").css("color", "dodgerblue")
                $(".roundbutton1").css("background-color","dodgerblue")
                $(".roundbutton1").css("color","white")
            });
            $(".roundbutton2").click(function () {
                $(".roundbutton1").css("background-color","white")
                $(".roundbutton1").css("color", "dodgerblue")
                $(".roundbutton2").css("background-color","dodgerblue")
                $(".roundbutton2").css("color","white")
            });
            $("#teamselected").click(function () {
                $("#initialization").css("display", "none");
                $("#teamconfirmation").css("display", "block");
                $("#navbartext").html("Is this correct?")
                $("#selectedround").html("ROUND " + publicround)
                $("#selectedrerun").html("NOT A RERUN")
                if ($("#rerun").is(":checked")) {
                    $("#selectedrerun").html("RERUN!")
                }
            });
            $("#incorrectselection").click(function () {
                $("#initialization").css("display", "block");
                $("#teamconfirmation").css("display", "none");
                $("#navbartext").html("Please revise your team selection...")
            })
            
        });
        $("#fieldn").change(function () {
            $("#fieldinput").val($("#fieldn").val());
        });
        $("#judgeconfirm").change(function () {
            $("#judgeconfirmhidden").val($("#judgeconfirm").val());
        });
        $("#studentconfirm").change(function () {
            $("#studentconfirmhidden").val($("#studentconfirm").val());
        });

        



    });


</script>
<br />


<script>
</script>



